---
title: "Assignment 7"
author: "Dr.Purna Gamage"
output: rmdformats::robobook
---

# K-mean Clustering

Let's create a function for K-means clustering algorithm.

![](c1.png)

#### Details of Above Figure

The progress of the K-means algorithm with K=3.

• <span style="color:green">Top left:</span> The observations are shown.

• <span style="color:green">Top center:</span> In Step 1 of the algorithm, each observation is randomly assigned to a cluster using some kind of a label. It could be "1", "2" or "green", "red" etc.

• <span style="color:green">Top right:</span> In Step 2(a), the cluster centroids are computed by taking the mean of each cluster assignment. These are shown as large colored disks. Initially the centroids are almost completely overlapping because the initial cluster assignments were chosen at random.

• <span style="color:green">Bottom left:</span> In Step 2(b), each observation is assigned to the nearest centroid. This is done by computing the euclidean distance between each point and each of the cluster centers. Each point is assigned to the centroid that resulted in the smallest euclidean distance. 

• <span style="color:green">Bottom center:</span> Step 2(a) is once again performed, leading to new cluster centroids.

• <span style="color:green">Bottom right:</span> The results obtained after 10 iterations.

Think about:

* The iterative steps for the algorithm. What is the starting point? What is the update rule for the centroids? What is the update rule for the "assignment" of each data point to a cluster?
* What data structures might you use for implementing this algorithm? DataFrames or vectors would be fine, just think about what you need to keep track of during each iteration.
* Within your implementation, create a way to visualize our 2D dataset during each implementation. That is, it is helpful to visualize the cluster "assignments" and centroids during each iteration. 

Let's first look at a simple simulated example in which there are only two real clusters in the data. We will create a dataset where the first 25 observations have a mean shift relative to the next 25 observations.

```{r }
makelinear = function(N,dist, makeplot = T){
  x=matrix(rnorm(4*N),2*N,2)
  y=rep(c(2,1),c(N,N))
  x[y==1,]=x[y==1,] + dist
  if(makeplot){plot(x,col=y+3,pch=19)}
  return(list(x=x,y=y))
}
```


```{r, message=FALSE, warning=FALSE}
library(tidyverse)
```


```{r}

A = makelinear(100, dist = 4.5, makeplot = F)
x = A$x
y = A$y

linear.data = data.frame(x,y=as.factor(y))

linear.data %>%
ggplot()+
  geom_point(aes(x=X1,y=X2,colour = y))+
  guides(colour=guide_legend(title="Cluster Labels")) 
```


Follow these steps to write the function for the algorithm:

1. Make a copy of "linear.data" and name it as `df`.

```{r}
# your code goes here
```

2. Create a variable name `label` that has 200 values of "1" and "2"; 100 each.

```{r}
# your code goes here
```


3. Get a random sample of size 200 from this label without replacement; and name the sample as `cl_label`.

```{r}
# your code goes here
```


4. Reset labels in `df` using `cl_label`.

```{r}
# your code goes here
```


5. Calculate the cluster centroids. `c1` would be the centroid (mean vector) of points that has the label "1" and `c2` would be the centroid (mean vector) of points that has the label "2".

```{r}
# your code goes here
```

6. Plot `X1` vs `X2` and color them according to the label. Are they separated yet?

```{r}
# your code goes here
```


7. Write a function to calculate the euclidean distance between each point and the cluster centroids.

```{r}
# your code goes here
```

_Next you need to re-assign the cluster labels according to the minimum distance between the cluster centroid and each point. We will do this inside a loop_

8. Write a for loop to repeat this algorithm:

a) Use an if-else statement to check which cluster centroid is closer to which point and re-assign the labels.

```{r}
# your code goes here
```
  
b) Calculate new cluster centroids as mentioned in part 5.

```{r}
# your code goes here
```
  
c) Repeat part a) and b) 10 times.

```{r}
# your code goes here
```

9. Plot the to see if there are 2 clear clusters.

```{r}
# your code goes here
```